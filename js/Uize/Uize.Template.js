/*
	UIZE JAVASCRIPT FRAMEWORK 2011-04-01

	http://www.uize.com/reference/Uize.Template.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Template',required:['Uize.Url','Uize.Json','Uize.String'],builder:function(){var _a=function(){},_b=true,_c=false,_d='string',_e=Uize.String,_f=_e.splitInTwo,_g=_e.trim;var _h={},_i=/^\s*=/,_j=/^\s*@/,_k=/^\s*\./,_l=/^!\s*/,_m=/(\r|\n|\r\n)[ \t]*$/,_n=/^[ \t]*(\r|\n|\r\n)[ \t]*/,_o='->',_p={};function _q(_r,_s,_t,_u){if(_s){_s=_s.split(_o);for(var _v= -1,_w=_s.length,_x,_y,_z,_A;++_v<_w;){if(_y=_g((_x=_f(_s[_t?_w-_v-1:_v],'{'))[0])){if(_z=_l.test(_y))_y=_y.replace(_l,'');if(_A=_a.encodings[_y]){if(_t)_z= !_z;var _B=_g(_x[1]),_C=_z?'from':'to',_D=_A[_C];_u&&_u(_y+':'+_C,_D.required);_r=_D.expansion(_r,_B?('{'+_B):'');}}}}return _r;}_a.compile=function(_E,_F){_F=_F||_h;var _G=[],_H={},_I={},_J={},_K=_F.openerToken||'<%',_L=_F.closerToken||'%>',_M=_F.gobbleWhitespace!==_c,_N=_E.length,_O='var output = [];',_P='return output.join (\'\');',_Q=[_O],_R=[],_S=0,_T,_U=_b,_V,_W,_X,_Y,_Z;function _0(_W){if(_R.length){_Q.push('output.push ('+_R.join(',')+');');_R=[];}_Q.push(_W);}
function required(_1){if(_1){if(typeof _1==_d)_1=_1.split(',');for(var _2= -1,_3=_1.length,_4;++_2<_3;){if(!_H[_4=_1[_2]]){_G.push(_4);_H[_4]=1;}}}}function input(_5){Uize.copyInto(_J,_5);}function startBlock(_6,_7){_0('function '+_6+' ('+(_7||'')+') {'+_O);}function endBlock(){_0(_P+'}');}while(_U){_T=_E.indexOf(_K,_S);if(_T<0)_T=_N;_V=_E.slice(_S,_T);if(_U=_T<_N){_S=_E.indexOf(_L,_T+=2);_Y=_i.test(_W=_E.slice(_T,_S));_Z=_Y||_k.test(_W);_X= !_Z&&_j.test(_W);_S+=2;}if(_V){if(_M&&_U&& !_Z&&_m.test(_V)&&_n.test(_E.substr(_S)))_V=_V.replace(_m,'');_V&&_R.push('\''+_V.replace(/\\/g,'\\\\').replace(/\n/g,'\\n').replace(/\r/g,'\\r').replace(/\'/g,'\\\'')+'\'');;}if(_U){if(_Z){var _8=_f(_Y?_W.replace(_i,''):'input'+_W,_o);_R.push(_q(_g(_8[0]),_8[1],_c,function(_9,_ba){if(!_I[_9]){required(_ba);_I[_9]=1;}}));}else if(_X){eval(_W.replace(_j,''));}else{_0(_W);}}}_0(_P);var _bb=_Q.join('\n'),_bc=new Function('input',_bb);return(_F.result=='full'?{input:_J,required:_G,code:_bb,templateFunction:_bc}:_bc);};
_a.encode=function(_bd,_s,_t){var _be=(_t?'! ':'')+_s;return((_p[_be]||(_p[_be]=new Function('e','return '+_q('e',_s,_t))))(_bd));};_a.decode=function(_bf,_A){return _a.encode(_bf,_A,_b)};var _bg=_a.encoders={},_bh=_a.decoders={},_bi=_a.defineStandardEncoding=function(_y,_bj,_bk,_bl){var _bm=_bj+'.'+_bl+' (',_bn=_bj+'.'+_bk+' (';if(_bj=='Uize.Json'||_bj=='Uize.Url'){var _bo=eval(_bj);_bg[_y]={encoder:_bo[_bk]};_bh[_y]={decoder:_bo[_bl]};}_a.encodings[_y]={to:{required:_bj,expansion:function(_bp,_bq){return _bn+_bp+(_bq&&',')+_bq+')'}},from:{required:_bj,expansion:function(_bp,_bq){return _bm+_bp+(_bq&&',')+_bq+')'}}};};_a.encodings={};_bi('iso8601','Uize.Date','toIso8601','fromIso8601');_bi('json','Uize.Json','to','from');_bi('miniJson','Uize.Json','to','from');_a.encodings.miniJson.to.expansion=function(_bp){return'Uize.Json.to ('+_bp+',\'mini\')'};_bg.miniJson.encoder=function(_br){return Uize.Json.to(_br,'mini')};_bi('tagAttributes','Uize.Xml','toAttributes','fromAttributes');
_bi('tagAttributeValue','Uize.Xml','toAttributeValue','fromAttributeValue');_bi('url','Uize.Url','resolve','from');_bi('urlParams','Uize.Url','toParams','fromParams');_bi('urlPiece','Uize.Url','toPiece','fromPiece');return _a;}});